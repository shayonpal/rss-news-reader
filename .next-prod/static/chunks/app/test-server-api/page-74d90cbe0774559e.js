(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{5698:function(e,s,a){Promise.resolve().then(a.bind(a,3598))},3598:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return l}});var t=a(7437),n=a(2265),i=a(7205);function l(){var e;let[s,a]=(0,n.useState)(null),[l,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[o,m]=(0,n.useState)(null),[h,u]=(0,n.useState)(null),[x,p]=(0,n.useState)(null),y=async()=>{p("sync");try{let e=await fetch("/reader/api/sync",{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();a({status:e.status,data:s}),s.syncId&&b(s.syncId)}catch(e){a({error:e instanceof Error?e.message:"Failed"})}finally{p(null)}},b=async e=>{let s=setInterval(async()=>{try{let a=await fetch("/reader/api/sync/status/".concat(e)),t=await a.json();r(t),("completed"===t.status||"failed"===t.status)&&clearInterval(s)}catch(e){clearInterval(s),r({error:"Failed to check status"})}},1e3)},g=async()=>{p("article");try{let{data:e,error:s}=await i.OQ.from("articles").select("id, title, url, content, ai_summary").limit(10);if(s)throw s;if(e&&e.length>0){let s=e[Math.floor(Math.random()*e.length)];u(s)}}catch(e){console.error("Failed to load article:",e)}finally{p(null)}},j=async()=>{if(h){p("content");try{let e=await fetch("/reader/api/articles/".concat(h.id,"/fetch-content"),{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();d({status:e.status,data:s})}catch(e){d({error:e instanceof Error?e.message:"Failed"})}finally{p(null)}}},f=async()=>{if(h){p("summary");try{let e=await fetch("/reader/api/articles/".concat(h.id,"/summarize"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({regenerate:!0})}),s=await e.json();m({status:e.status,data:s})}catch(e){m({error:e instanceof Error?e.message:"Failed"})}finally{p(null)}}};return(0,t.jsxs)("div",{className:"container mx-auto p-8 space-y-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Server API Test Page"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Test the US-103 server API endpoints"}),(0,t.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Manual Sync"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"POST /api/sync - Trigger server-side sync"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:y,disabled:"sync"===x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"sync"===x?"Syncing...":"Start Sync"}),s&&(0,t.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-auto text-xs",children:JSON.stringify(s,null,2)}),l&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Sync Status:"}),(0,t.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-auto text-xs",children:JSON.stringify(l,null,2)})]})]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Select Test Article"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Load a random article for testing content extraction and summarization"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:g,disabled:"article"===x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"article"===x?"Loading...":"Load Random Article"}),h&&(0,t.jsxs)("div",{className:"bg-gray-100 p-4 rounded space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Title:"})," ",h.title]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"ID:"})," ",h.id]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"URL:"})," ",h.url||"No URL"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Has Summary:"})," ",h.ai_summary?"Yes":"No"]})]})]})]}),h&&(0,t.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Content Extraction"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["POST /api/articles/","{id}","/fetch-content - Extract full article content"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:j,disabled:"content"===x||!h.url,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"content"===x?"Extracting...":"Extract Content"}),c&&(0,t.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-auto text-xs max-h-64",children:JSON.stringify(c,null,2)})]})]}),h&&(0,t.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"AI Summarization"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["POST /api/articles/","{id}","/summarize - Generate AI summary"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:f,disabled:"summary"===x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"summary"===x?"Generating...":"Generate Summary"}),o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-auto text-xs max-h-64",children:JSON.stringify(o,null,2)}),(null===(e=o.data)||void 0===e?void 0:e.summary)&&(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded",children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Generated Summary:"}),(0,t.jsx)("p",{className:"text-sm",children:o.data.summary})]})]})]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"API Documentation"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"US-103 Implementation Details"}),(0,t.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:"✅ Completed Endpoints:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[(0,t.jsx)("li",{children:"POST /api/sync - Trigger manual sync (with rate limiting)"}),(0,t.jsx)("li",{children:"GET /api/sync/status/:id - Check sync progress"}),(0,t.jsx)("li",{children:"POST /api/articles/:id/fetch-content - Extract full content using Mozilla Readability"}),(0,t.jsx)("li",{children:"POST /api/articles/:id/summarize - Generate AI summary using Claude 4 Sonnet"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:"✅ Features Implemented:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[(0,t.jsx)("li",{children:"Rate limiting (100 calls/day for Inoreader API)"}),(0,t.jsx)("li",{children:"Proper error codes (429 for rate limit, 404 for not found, 500 for server errors)"}),(0,t.jsx)("li",{children:"Consistent JSON response format"}),(0,t.jsx)("li",{children:"API usage tracking in api_usage table"}),(0,t.jsx)("li",{children:"Content caching to avoid repeated extractions"}),(0,t.jsx)("li",{children:"Summary caching with regeneration option"})]})]})]})]})]})}},7205:function(e,s,a){"use strict";a.d(s,{OQ:function(){return r}});var t=a(6580);let n="https://rgfxyraamghqnechkppg.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnZnh5cmFhbWdocW5lY2hrcHBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2ODg5NzAsImV4cCI6MjA2ODI2NDk3MH0.hqoXq2YAs6cc96d0baVjZWVdmDW0qytCIHjA-YffSdk";if(!n||!i)throw Error("Missing Supabase environment variables");console.log("[Supabase] Initializing client...");let l=performance.now(),r=(0,t.eI)(n,i,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"}});console.log("[Supabase] Client initialized in ".concat((performance.now()-l).toFixed(2),"ms"))}},function(e){e.O(0,[580,971,117,744],function(){return e(e.s=5698)}),_N_E=e.O()}]);